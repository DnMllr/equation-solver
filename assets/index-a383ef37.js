(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();const Ht=(e,t)=>e===t,B=Symbol("solid-proxy"),Me=Symbol("solid-track"),ve={equals:Ht};let Xt=xt;const X=1,be=2,gt={owned:null,cleanups:null,context:null,owner:null};var O=null;let Ee=null,w=null,T=null,H=null,ye=0;function he(e,t){const r=w,n=O,i=e.length===0,s=i?gt:{owned:null,cleanups:null,context:null,owner:t===void 0?n:t},l=i?e:()=>e(()=>z(()=>xe(s)));O=s,w=null;try{return se(l,!0)}finally{w=r,O=n}}function Ke(e,t){t=t?Object.assign({},ve,t):ve;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),yt(r,i));return[pt.bind(r),n]}function I(e,t,r){const n=mt(e,t,!1,X);we(n)}function q(e,t,r){r=r?Object.assign({},ve,r):ve;const n=mt(e,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,we(n),pt.bind(n)}function Gt(e){return se(e,!1)}function z(e){if(w===null)return e();const t=w;w=null;try{return e()}finally{w=t}}function vt(e){return O===null||(O.cleanups===null?O.cleanups=[e]:O.cleanups.push(e)),e}function bt(){return w}function Wt(){return O}function me(e){const t=q(e),r=q(()=>Ne(t()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function pt(){if(this.sources&&this.state)if(this.state===X)we(this);else{const e=T;T=null,se(()=>pe(this),!1),T=e}if(w){const e=this.observers?this.observers.length:0;w.sources?(w.sources.push(this),w.sourceSlots.push(e)):(w.sources=[this],w.sourceSlots=[e]),this.observers?(this.observers.push(w),this.observerSlots.push(w.sources.length-1)):(this.observers=[w],this.observerSlots=[w.sources.length-1])}return this.value}function yt(e,t,r){let n=e.value;return(!e.comparator||!e.comparator(n,t))&&(e.value=t,e.observers&&e.observers.length&&se(()=>{for(let i=0;i<e.observers.length;i+=1){const s=e.observers[i],l=Ee&&Ee.running;l&&Ee.disposed.has(s),(l?!s.tState:!s.state)&&(s.pure?T.push(s):H.push(s),s.observers&&$t(s)),l||(s.state=X)}if(T.length>1e6)throw T=[],new Error},!1)),t}function we(e){if(!e.fn)return;xe(e);const t=O,r=w,n=ye;w=O=e,Jt(e,e.value,n),w=r,O=t}function Jt(e,t,r){let n;try{n=e.fn(t)}catch(i){return e.pure&&(e.state=X,e.owned&&e.owned.forEach(xe),e.owned=null),e.updatedAt=r+1,kt(i)}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?yt(e,n):e.value=n,e.updatedAt=r)}function mt(e,t,r,n=X,i){const s={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:O,context:null,pure:r};return O===null||O!==gt&&(O.owned?O.owned.push(s):O.owned=[s]),s}function wt(e){if(e.state===0)return;if(e.state===be)return pe(e);if(e.suspense&&z(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<ye);)e.state&&t.push(e);for(let r=t.length-1;r>=0;r--)if(e=t[r],e.state===X)we(e);else if(e.state===be){const n=T;T=null,se(()=>pe(e,t[0]),!1),T=n}}function se(e,t){if(T)return e();let r=!1;t||(T=[]),H?r=!0:H=[],ye++;try{const n=e();return Qt(r),n}catch(n){r||(H=null),T=null,kt(n)}}function Qt(e){if(T&&(xt(T),T=null),e)return;const t=H;H=null,t.length&&se(()=>Xt(t),!1)}function xt(e){for(let t=0;t<e.length;t++)wt(e[t])}function pe(e,t){e.state=0;for(let r=0;r<e.sources.length;r+=1){const n=e.sources[r];if(n.sources){const i=n.state;i===X?n!==t&&(!n.updatedAt||n.updatedAt<ye)&&wt(n):i===be&&pe(n,t)}}}function $t(e){for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t];r.state||(r.state=be,r.pure?T.push(r):H.push(r),r.observers&&$t(r))}}function xe(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),i=r.observers;if(i&&i.length){const s=i.pop(),l=r.observerSlots.pop();n<i.length&&(s.sourceSlots[l]=n,i[n]=s,r.observerSlots[n]=l)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)xe(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function kt(e){throw e}function Ne(e){if(typeof e=="function"&&!e.length)return Ne(e());if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++){const n=Ne(e[r]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return e}const Yt=Symbol("fallback");function nt(e){for(let t=0;t<e.length;t++)e[t]()}function Zt(e,t,r={}){let n=[],i=[],s=[],l=0,o=t.length>1?[]:null;return vt(()=>nt(s)),()=>{let u=e()||[],a,c;return u[Me],z(()=>{let d=u.length,v,m,y,k,S,j,A,R,G;if(d===0)l!==0&&(nt(s),s=[],n=[],i=[],l=0,o&&(o=[])),r.fallback&&(n=[Yt],i[0]=he(Kt=>(s[0]=Kt,r.fallback())),l=1);else if(l===0){for(i=new Array(d),c=0;c<d;c++)n[c]=u[c],i[c]=he(f);l=d}else{for(y=new Array(d),k=new Array(d),o&&(S=new Array(d)),j=0,A=Math.min(l,d);j<A&&n[j]===u[j];j++);for(A=l-1,R=d-1;A>=j&&R>=j&&n[A]===u[R];A--,R--)y[R]=i[A],k[R]=s[A],o&&(S[R]=o[A]);for(v=new Map,m=new Array(R+1),c=R;c>=j;c--)G=u[c],a=v.get(G),m[c]=a===void 0?-1:a,v.set(G,c);for(a=j;a<=A;a++)G=n[a],c=v.get(G),c!==void 0&&c!==-1?(y[c]=i[a],k[c]=s[a],o&&(S[c]=o[a]),c=m[c],v.set(G,c)):s[a]();for(c=j;c<d;c++)c in y?(i[c]=y[c],s[c]=k[c],o&&(o[c]=S[c],o[c](c))):i[c]=he(f);i=i.slice(0,l=d),n=u.slice(0)}return i});function f(d){if(s[c]=d,o){const[v,m]=Ke(c);return o[c]=m,t(u[c],v)}return t(u[c])}}}function h(e,t){return z(()=>e(t||{}))}function fe(){return!0}const Ie={get(e,t,r){return t===B?r:e.get(t)},has(e,t){return t===B?!0:e.has(t)},set:fe,deleteProperty:fe,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:fe,deleteProperty:fe}},ownKeys(e){return e.keys()}};function Pe(e){return(e=typeof e=="function"?e():e)?e:{}}function er(){for(let e=0,t=this.length;e<t;++e){const r=this[e]();if(r!==void 0)return r}}function st(...e){let t=!1;for(let s=0;s<e.length;s++){const l=e[s];t=t||!!l&&B in l,e[s]=typeof l=="function"?(t=!0,q(l)):l}if(t)return new Proxy({get(s){for(let l=e.length-1;l>=0;l--){const o=Pe(e[l])[s];if(o!==void 0)return o}},has(s){for(let l=e.length-1;l>=0;l--)if(s in Pe(e[l]))return!0;return!1},keys(){const s=[];for(let l=0;l<e.length;l++)s.push(...Object.keys(Pe(e[l])));return[...new Set(s)]}},Ie);const r={},n={};let i=!1;for(let s=e.length-1;s>=0;s--){const l=e[s];if(!l)continue;const o=Object.getOwnPropertyNames(l);i=i||s!==0&&!!o.length;for(let u=0,a=o.length;u<a;u++){const c=o[u];if(!(c==="__proto__"||c==="constructor"))if(c in r){const f=n[c],d=Object.getOwnPropertyDescriptor(l,c);f?d.get?f.push(d.get.bind(l)):d.value!==void 0&&f.push(()=>d.value):r[c]===void 0&&(r[c]=d.value)}else{const f=Object.getOwnPropertyDescriptor(l,c);f.get?Object.defineProperty(r,c,{enumerable:!0,configurable:!0,get:er.bind(n[c]=[f.get.bind(l)])}):r[c]=f.value}}}return r}function tr(e,...t){if(B in e){const i=new Set(t.length>1?t.flat():t[0]),s=t.map(l=>new Proxy({get(o){return l.includes(o)?e[o]:void 0},has(o){return l.includes(o)&&o in e},keys(){return l.filter(o=>o in e)}},Ie));return s.push(new Proxy({get(l){return i.has(l)?void 0:e[l]},has(l){return i.has(l)?!1:l in e},keys(){return Object.keys(e).filter(l=>!i.has(l))}},Ie)),s}const r={},n=t.map(()=>({}));for(const i of Object.getOwnPropertyNames(e)){const s=Object.getOwnPropertyDescriptor(e,i),l=!s.get&&!s.set&&s.enumerable&&s.writable&&s.configurable;let o=!1,u=0;for(const a of t)a.includes(i)&&(o=!0,l?n[u][i]=s.value:Object.defineProperty(n[u],i,s)),++u;o||(l?r[i]=s.value:Object.defineProperty(r,i,s))}return[...n,r]}const Ot=e=>`Stale read from <${e}>.`;function He(e){const t="fallback"in e&&{fallback:()=>e.fallback};return q(Zt(()=>e.each,e.children,t||void 0))}function ge(e){const t=e.keyed,r=q(()=>e.when,void 0,{equals:(n,i)=>t?n===i:!n==!i});return q(()=>{const n=r();if(n){const i=e.children;return typeof i=="function"&&i.length>0?z(()=>i(t?n:()=>{if(!z(r))throw Ot("Show");return e.when})):i}return e.fallback},void 0,void 0)}function $e(e){let t=!1;const r=(s,l)=>s[0]===l[0]&&(t?s[1]===l[1]:!s[1]==!l[1])&&s[2]===l[2],n=me(()=>e.children),i=q(()=>{let s=n();Array.isArray(s)||(s=[s]);for(let l=0;l<s.length;l++){const o=s[l].when;if(o)return t=!!s[l].keyed,[l,o,s[l]]}return[-1]},void 0,{equals:r});return q(()=>{const[s,l,o]=i();if(s<0)return e.fallback;const u=o.children;return typeof u=="function"&&u.length>0?z(()=>u(t?l:()=>{if(z(i)[0]!==s)throw Ot("Match");return o.when})):u},void 0,void 0)}function E(e){return e}const rr=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],nr=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...rr]),sr=new Set(["innerHTML","textContent","innerText","children"]),ir=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),lr=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function or(e,t){const r=lr[e];return typeof r=="object"?r[t]?r.$:void 0:r}const ur=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),cr={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function ar(e,t,r){let n=r.length,i=t.length,s=n,l=0,o=0,u=t[i-1].nextSibling,a=null;for(;l<i||o<s;){if(t[l]===r[o]){l++,o++;continue}for(;t[i-1]===r[s-1];)i--,s--;if(i===l){const c=s<n?o?r[o-1].nextSibling:r[s-o]:u;for(;o<s;)e.insertBefore(r[o++],c)}else if(s===o)for(;l<i;)(!a||!a.has(t[l]))&&t[l].remove(),l++;else if(t[l]===r[s-1]&&r[o]===t[i-1]){const c=t[--i].nextSibling;e.insertBefore(r[o++],t[l++].nextSibling),e.insertBefore(r[--s],c),t[i]=r[s]}else{if(!a){a=new Map;let f=o;for(;f<s;)a.set(r[f],f++)}const c=a.get(t[l]);if(c!=null)if(o<c&&c<s){let f=l,d=1,v;for(;++f<i&&f<s&&!((v=a.get(t[f]))==null||v!==c+d);)d++;if(d>c-o){const m=t[l];for(;o<c;)e.insertBefore(r[o++],m)}else e.replaceChild(r[o++],t[l++])}else l++;else t[l++].remove()}}}const it="_$DX_DELEGATE";function fr(e,t,r,n={}){let i;return he(s=>{i=s,t===document?e():g(t,e(),t.firstChild?null:void 0,r)},n.owner),()=>{i(),t.textContent=""}}function p(e,t,r){let n;const i=()=>{const l=document.createElement("template");return l.innerHTML=e,r?l.content.firstChild.firstChild:l.content.firstChild},s=t?()=>z(()=>document.importNode(n||(n=i()),!0)):()=>(n||(n=i())).cloneNode(!0);return s.cloneNode=s,s}function Xe(e,t=window.document){const r=t[it]||(t[it]=new Set);for(let n=0,i=e.length;n<i;n++){const s=e[n];r.has(s)||(r.add(s),t.addEventListener(s,mr))}}function Le(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r)}function dr(e,t,r,n){n==null?e.removeAttributeNS(t,r):e.setAttributeNS(t,r,n)}function ie(e,t){t==null?e.removeAttribute("class"):e.className=t}function hr(e,t,r,n){if(n)Array.isArray(r)?(e[`$$${t}`]=r[0],e[`$$${t}Data`]=r[1]):e[`$$${t}`]=r;else if(Array.isArray(r)){const i=r[0];e.addEventListener(t,r[0]=s=>i.call(e,r[1],s))}else e.addEventListener(t,r)}function gr(e,t,r={}){const n=Object.keys(t||{}),i=Object.keys(r);let s,l;for(s=0,l=i.length;s<l;s++){const o=i[s];!o||o==="undefined"||t[o]||(lt(e,o,!1),delete r[o])}for(s=0,l=n.length;s<l;s++){const o=n[s],u=!!t[o];!o||o==="undefined"||r[o]===u||!u||(lt(e,o,!0),r[o]=u)}return r}function vr(e,t,r){if(!t)return r?Le(e,"style"):t;const n=e.style;if(typeof t=="string")return n.cssText=t;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),t||(t={});let i,s;for(s in r)t[s]==null&&n.removeProperty(s),delete r[s];for(s in t)i=t[s],i!==r[s]&&(n.setProperty(s,i),r[s]=i);return r}function br(e,t={},r,n){const i={};return n||I(()=>i.children=Q(e,t.children,i.children)),I(()=>t.ref&&t.ref(e)),I(()=>pr(e,t,r,!0,i,!0)),i}function g(e,t,r,n){if(r!==void 0&&!n&&(n=[]),typeof t!="function")return Q(e,t,n,r);I(i=>Q(e,t(),i,r),n)}function pr(e,t,r,n,i={},s=!1){t||(t={});for(const l in i)if(!(l in t)){if(l==="children")continue;i[l]=ot(e,l,null,i[l],r,s)}for(const l in t){if(l==="children"){n||Q(e,t.children);continue}const o=t[l];i[l]=ot(e,l,o,i[l],r,s)}}function yr(e){return e.toLowerCase().replace(/-([a-z])/g,(t,r)=>r.toUpperCase())}function lt(e,t,r){const n=t.trim().split(/\s+/);for(let i=0,s=n.length;i<s;i++)e.classList.toggle(n[i],r)}function ot(e,t,r,n,i,s){let l,o,u,a,c;if(t==="style")return vr(e,r,n);if(t==="classList")return gr(e,r,n);if(r===n)return n;if(t==="ref")s||r(e);else if(t.slice(0,3)==="on:"){const f=t.slice(3);n&&e.removeEventListener(f,n),r&&e.addEventListener(f,r)}else if(t.slice(0,10)==="oncapture:"){const f=t.slice(10);n&&e.removeEventListener(f,n,!0),r&&e.addEventListener(f,r,!0)}else if(t.slice(0,2)==="on"){const f=t.slice(2).toLowerCase(),d=ur.has(f);if(!d&&n){const v=Array.isArray(n)?n[0]:n;e.removeEventListener(f,v)}(d||r)&&(hr(e,f,r,d),d&&Xe([f]))}else if(t.slice(0,5)==="attr:")Le(e,t.slice(5),r);else if((c=t.slice(0,5)==="prop:")||(u=sr.has(t))||!i&&((a=or(t,e.tagName))||(o=nr.has(t)))||(l=e.nodeName.includes("-")))c&&(t=t.slice(5),o=!0),t==="class"||t==="className"?ie(e,r):l&&!o&&!u?e[yr(t)]=r:e[a||t]=r;else{const f=i&&t.indexOf(":")>-1&&cr[t.split(":")[0]];f?dr(e,f,t,r):Le(e,ir[t]||t,r)}return r}function mr(e){const t=`$$${e.type}`;let r=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==r&&Object.defineProperty(e,"target",{configurable:!0,value:r}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return r||document}});r;){const n=r[t];if(n&&!r.disabled){const i=r[`${t}Data`];if(i!==void 0?n.call(r,i,e):n.call(r,e),e.cancelBubble)return}r=r._$host||r.parentNode||r.host}}function Q(e,t,r,n,i){for(;typeof r=="function";)r=r();if(t===r)return r;const s=typeof t,l=n!==void 0;if(e=l&&r[0]&&r[0].parentNode||e,s==="string"||s==="number")if(s==="number"&&(t=t.toString()),l){let o=r[0];o&&o.nodeType===3?o.data=t:o=document.createTextNode(t),r=W(e,r,n,o)}else r!==""&&typeof r=="string"?r=e.firstChild.data=t:r=e.textContent=t;else if(t==null||s==="boolean")r=W(e,r,n);else{if(s==="function")return I(()=>{let o=t();for(;typeof o=="function";)o=o();r=Q(e,o,r,n)}),()=>r;if(Array.isArray(t)){const o=[],u=r&&Array.isArray(r);if(Be(o,t,r,i))return I(()=>r=Q(e,o,r,n,!0)),()=>r;if(o.length===0){if(r=W(e,r,n),l)return r}else u?r.length===0?ut(e,o,n):ar(e,r,o):(r&&W(e),ut(e,o));r=o}else if(t.nodeType){if(Array.isArray(r)){if(l)return r=W(e,r,n,t);W(e,r,null,t)}else r==null||r===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);r=t}else console.warn("Unrecognized value. Skipped inserting",t)}return r}function Be(e,t,r,n){let i=!1;for(let s=0,l=t.length;s<l;s++){let o=t[s],u=r&&r[s],a;if(!(o==null||o===!0||o===!1))if((a=typeof o)=="object"&&o.nodeType)e.push(o);else if(Array.isArray(o))i=Be(e,o,u)||i;else if(a==="function")if(n){for(;typeof o=="function";)o=o();i=Be(e,Array.isArray(o)?o:[o],Array.isArray(u)?u:[u])||i}else e.push(o),i=!0;else{const c=String(o);u&&u.nodeType===3&&u.data===c?e.push(u):e.push(document.createTextNode(c))}}return i}function ut(e,t,r=null){for(let n=0,i=t.length;n<i;n++)e.insertBefore(t[n],r)}function W(e,t,r,n){if(r===void 0)return e.textContent="";const i=n||document.createTextNode("");if(t.length){let s=!1;for(let l=t.length-1;l>=0;l--){const o=t[l];if(i!==o){const u=o.parentNode===e;!s&&!l?u?e.replaceChild(i,o):e.insertBefore(i,r):u&&o.remove()}else s=!0}}else e.insertBefore(i,r);return[i]}const wr=!1;const De=Symbol("store-raw"),ue=Symbol("store-node");function Tt(e){let t=e[B];if(!t&&(Object.defineProperty(e,B,{value:t=new Proxy(e,kr)}),!Array.isArray(e))){const r=Object.keys(e),n=Object.getOwnPropertyDescriptors(e);for(let i=0,s=r.length;i<s;i++){const l=r[i];n[l].get&&Object.defineProperty(e,l,{enumerable:n[l].enumerable,get:n[l].get.bind(t)})}}return t}function K(e){let t;return e!=null&&typeof e=="object"&&(e[B]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Y(e,t=new Set){let r,n,i,s;if(r=e!=null&&e[De])return r;if(!K(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let l=0,o=e.length;l<o;l++)i=e[l],(n=Y(i,t))!==i&&(e[l]=n)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const l=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let u=0,a=l.length;u<a;u++)s=l[u],!o[s].get&&(i=e[s],(n=Y(i,t))!==i&&(e[s]=n))}return e}function Ge(e){let t=e[ue];return t||Object.defineProperty(e,ue,{value:t=Object.create(null)}),t}function Re(e,t,r){return e[t]||(e[t]=_t(r))}function xr(e,t){const r=Reflect.getOwnPropertyDescriptor(e,t);return!r||r.get||!r.configurable||t===B||t===ue||(delete r.value,delete r.writable,r.get=()=>e[B][t]),r}function St(e){if(bt()){const t=Ge(e);(t._||(t._=_t()))()}}function $r(e){return St(e),Reflect.ownKeys(e)}function _t(e){const[t,r]=Ke(e,{equals:!1,internal:!0});return t.$=r,t}const kr={get(e,t,r){if(t===De)return e;if(t===B)return r;if(t===Me)return St(e),r;const n=Ge(e),i=n[t];let s=i?i():e[t];if(t===ue||t==="__proto__")return s;if(!i){const l=Object.getOwnPropertyDescriptor(e,t);bt()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(l&&l.get)&&(s=Re(n,t,s)())}return K(s)?Tt(s):s},has(e,t){return t===De||t===B||t===Me||t===ue||t==="__proto__"?!0:(this.get(e,t,e),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:$r,getOwnPropertyDescriptor:xr};function M(e,t,r,n=!1){if(!n&&e[t]===r)return;const i=e[t],s=e.length;r===void 0?delete e[t]:e[t]=r;let l=Ge(e),o;if((o=Re(l,t,i))&&o.$(()=>r),Array.isArray(e)&&e.length!==s){for(let u=e.length;u<s;u++)(o=l[u])&&o.$();(o=Re(l,"length",s))&&o.$(e.length)}(o=l._)&&o.$()}function Et(e,t){const r=Object.keys(t);for(let n=0;n<r.length;n+=1){const i=r[n];M(e,i,t[i])}}function Or(e,t){if(typeof t=="function"&&(t=t(e)),t=Y(t),Array.isArray(t)){if(e===t)return;let r=0,n=t.length;for(;r<n;r++){const i=t[r];e[r]!==i&&M(e,r,i)}M(e,"length",n)}else Et(e,t)}function oe(e,t,r=[]){let n,i=e;if(t.length>1){n=t.shift();const l=typeof n,o=Array.isArray(e);if(Array.isArray(n)){for(let u=0;u<n.length;u++)oe(e,[n[u]].concat(t),r);return}else if(o&&l==="function"){for(let u=0;u<e.length;u++)n(e[u],u)&&oe(e,[u].concat(t),r);return}else if(o&&l==="object"){const{from:u=0,to:a=e.length-1,by:c=1}=n;for(let f=u;f<=a;f+=c)oe(e,[f].concat(t),r);return}else if(t.length>1){oe(e[n],t,[n].concat(r));return}i=e[n],r=[n].concat(r)}let s=t[0];typeof s=="function"&&(s=s(i,r),s===i)||n===void 0&&s==null||(s=Y(s),n===void 0||K(i)&&K(s)&&!Array.isArray(s)?Et(i,s):M(e,n,s))}function We(...[e,t]){const r=Y(e||{}),n=Array.isArray(r),i=Tt(r);function s(...l){Gt(()=>{n&&l.length===1?Or(r,l[0]):oe(r,l)})}return[i,s]}const Fe=Symbol("store-root");function J(e,t,r,n,i){const s=t[r];if(e===s)return;if(r!==Fe&&(!K(e)||!K(s)||i&&e[i]!==s[i])){M(t,r,e);return}if(Array.isArray(e)){if(e.length&&s.length&&(!n||i&&e[0]&&e[0][i]!=null)){let u,a,c,f,d,v,m,y;for(c=0,f=Math.min(s.length,e.length);c<f&&(s[c]===e[c]||i&&s[c]&&e[c]&&s[c][i]===e[c][i]);c++)J(e[c],s,c,n,i);const k=new Array(e.length),S=new Map;for(f=s.length-1,d=e.length-1;f>=c&&d>=c&&(s[f]===e[d]||i&&s[c]&&e[c]&&s[f][i]===e[d][i]);f--,d--)k[d]=s[f];if(c>d||c>f){for(a=c;a<=d;a++)M(s,a,e[a]);for(;a<e.length;a++)M(s,a,k[a]),J(e[a],s,a,n,i);s.length>e.length&&M(s,"length",e.length);return}for(m=new Array(d+1),a=d;a>=c;a--)v=e[a],y=i&&v?v[i]:v,u=S.get(y),m[a]=u===void 0?-1:u,S.set(y,a);for(u=c;u<=f;u++)v=s[u],y=i&&v?v[i]:v,a=S.get(y),a!==void 0&&a!==-1&&(k[a]=s[u],a=m[a],S.set(y,a));for(a=c;a<e.length;a++)a in k?(M(s,a,k[a]),J(e[a],s,a,n,i)):M(s,a,e[a])}else for(let u=0,a=e.length;u<a;u++)J(e[u],s,u,n,i);s.length>e.length&&M(s,"length",e.length);return}const l=Object.keys(e);for(let u=0,a=l.length;u<a;u++)J(e[l[u]],s,l[u],n,i);const o=Object.keys(s);for(let u=0,a=o.length;u<a;u++)e[o[u]]===void 0&&M(s,o[u],void 0)}function Ae(e,t={}){const{merge:r,key:n="id"}=t,i=Y(e);return s=>{if(!K(s)||!K(i))return i;const l=J(i,{[Fe]:s},Fe,r,n);return l===void 0?s:l}}var Tr=(e,t)=>{let r;const n=()=>clearTimeout(r);return Wt()&&vt(n),Object.assign((...s)=>{r!==void 0&&n(),r=setTimeout(()=>e(...s),t)},{clear:n})},V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b={},C={},Pt=V&&V.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(C,"__esModule",{value:!0});C.buildLexer=C.extractByTokenRange=C.extractByPositionRange=C.TokenRangeError=C.TokenError=void 0;function qe(e){return e===void 0?"<END-OF-FILE>":JSON.stringify(e)}var At=function(e){Pt(t,e);function t(r,n){var i=e.call(this,qe(r)+": "+n)||this;return i.pos=r,i.errorMessage=n,i}return t}(Error);C.TokenError=At;var Sr=function(e){Pt(t,e);function t(r,n,i){var s=e.call(this,qe(r)+" - "+qe(n)+": "+i)||this;return s.first=r,s.next=n,s.errorMessage=i,s}return t}(Error);C.TokenRangeError=Sr;function Ct(e,t,r){var n=t===void 0?e.length:t.index,i=r===void 0?e.length:r.index;return n>=i?"":e.substring(n,i)}C.extractByPositionRange=Ct;function _r(e,t,r){return Ct(e,t===void 0?void 0:t.pos,r===void 0?void 0:r.pos)}C.extractByTokenRange=_r;var Er=function(){function e(t,r,n,i,s,l){this.lexer=t,this.input=r,this.kind=n,this.text=i,this.pos=s,this.keep=l}return Object.defineProperty(e.prototype,"next",{get:function(){return this.nextToken===void 0&&(this.nextToken=this.lexer.parseNextAvailable(this.input,this.pos.index+this.text.length,this.pos.rowEnd,this.pos.columnEnd),this.nextToken===void 0&&(this.nextToken=null)),this.nextToken===null?void 0:this.nextToken},enumerable:!1,configurable:!0}),e}(),Pr=function(){function e(t){this.rules=t;for(var r=0,n=this.rules;r<n.length;r++){var i=n[r];if(i[1].source[0]!=="^")throw new Error('Regular expression patterns for a tokenizer should start with "^": '+i[1].source);if(!i[1].global)throw new Error("Regular expression patterns for a tokenizer should be global: "+i[1].source)}}return e.prototype.parse=function(t){return this.parseNextAvailable(t,0,1,1)},e.prototype.parseNext=function(t,r,n,i){if(r!==t.length){for(var s=t.substr(r),l,o=0,u=this.rules;o<u.length;o++){var a=u[o],c=a[0],f=a[1],d=a[2];if(f.lastIndex=0,f.test(s)){for(var v=s.substr(0,f.lastIndex),m=n,y=i,k=0,S=v;k<S.length;k++){var j=S[k];switch(j){case"\r":break;case`
`:m++,y=1;break;default:y++}}var A=new Er(this,t,d,v,{index:r,rowBegin:n,columnBegin:i,rowEnd:m,columnEnd:y},c);(l===void 0||l.text.length<A.text.length)&&(l=A)}}if(l===void 0)throw new At({index:r,rowBegin:n,columnBegin:i,rowEnd:n,columnEnd:i},"Unable to tokenize the rest of the input: "+t.substr(r));return l}},e.prototype.parseNextAvailable=function(t,r,n,i){for(var s;;){if(s=this.parseNext(t,s===void 0?r:s.pos.index+s.text.length,s===void 0?n:s.pos.rowEnd,s===void 0?i:s.pos.columnEnd),s===void 0)return;if(s.keep)return s}},e}();function Ar(e){return new Pr(e)}C.buildLexer=Ar;var _={};Object.defineProperty(_,"__esModule",{value:!0});_.unableToConsumeToken=_.resultOrError=_.betterError=void 0;function Cr(e,t){return e===void 0?t:t===void 0||e.pos===void 0?e:t.pos===void 0||e.pos.index<t.pos.index?t:(e.pos.index>t.pos.index,e)}_.betterError=Cr;function jr(e,t,r){return r?{candidates:e,successful:!0,error:t}:{successful:!1,error:t}}_.resultOrError=jr;function Mr(e){return{kind:"Error",pos:e===void 0?void 0:e.pos,message:"Unable to consume token: "+(e===void 0?"<END-OF-FILE>":e.text)}}_.unableToConsumeToken=Mr;var P={};Object.defineProperty(P,"__esModule",{value:!0});P.tok=P.str=P.fail=P.succ=P.nil=void 0;var jt=_;function Nr(){return{parse:function(e){return{candidates:[{firstToken:e,nextToken:e,result:void 0}],successful:!0,error:void 0}}}}P.nil=Nr;function Ir(e){return{parse:function(t){return{candidates:[{firstToken:t,nextToken:t,result:e}],successful:!0,error:void 0}}}}P.succ=Ir;function Lr(e){return{parse:function(t){return{successful:!1,error:{kind:"Error",pos:t?.pos,message:e}}}}}P.fail=Lr;function Br(e){return{parse:function(t){return t===void 0||t.text!==e?{successful:!1,error:jt.unableToConsumeToken(t)}:{candidates:[{firstToken:t,nextToken:t.next,result:t}],successful:!0,error:void 0}}}}P.str=Br;function Dr(e){return{parse:function(t){return t===void 0||t.kind!==e?{successful:!1,error:jt.unableToConsumeToken(t)}:{candidates:[{firstToken:t,nextToken:t.next,result:t}],successful:!0,error:void 0}}}}P.tok=Dr;var ke={};Object.defineProperty(ke,"__esModule",{value:!0});ke.combine=void 0;var ct=_;function Rr(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return{parse:function(n){var i=e.parse(n);if(!i.successful)return i;for(var s=i.candidates,l=i.error,o=0,u=t;o<u.length;o++){var a=u[o];if(s.length===0)break;var c=s;s=[];for(var f=0,d=c;f<d.length;f++){var v=d[f],m=a(v.result).parse(v.nextToken);if(l=ct.betterError(l,m.error),m.successful)for(var y=0,k=m.candidates;y<k.length;y++){var S=k[y];s.push({firstToken:v.firstToken,nextToken:S.nextToken,result:S.result})}}}return ct.resultOrError(s,l,s.length!==0)}}}ke.combine=Rr;var le={};Object.defineProperty(le,"__esModule",{value:!0});le.seq=void 0;var at=_;function Fr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{parse:function(r){for(var n,i=[{firstToken:r,nextToken:r,result:[]}],s=0,l=e;s<l.length;s++){var o=l[s];if(i.length===0)break;var u=i;i=[];for(var a=0,c=u;a<c.length;a++){var f=c[a],d=o.parse(f.nextToken);if(n=at.betterError(n,d.error),d.successful)for(var v=0,m=d.candidates;v<m.length;v++){var y=m[v];i.push({firstToken:f.firstToken,nextToken:y.nextToken,result:f.result.concat([y.result])})}}}return at.resultOrError(i,n,i.length!==0)}}}le.seq=Fr;var ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.alt=void 0;var ft=_;function qr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{parse:function(r){for(var n,i=[],s=!1,l=0,o=e;l<o.length;l++){var u=o[l],a=u.parse(r);n=ft.betterError(n,a.error),a.successful&&(i=i.concat(a.candidates),s=!0)}return ft.resultOrError(i,n,s)}}}ce.alt=qr;var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.alt_sc=void 0;var dt=_;function zr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{parse:function(r){for(var n,i=0,s=e;i<s.length;i++){var l=s[i],o=l.parse(r);if(n=dt.betterError(n,o.error),o.successful)return dt.resultOrError(o.candidates,n,!0)}return{successful:!1,error:n}}}}Oe.alt_sc=zr;var Z={};Object.defineProperty(Z,"__esModule",{value:!0});Z.opt_sc=Z.opt=void 0;var Vr=ce,Ur=P;function Kr(e){return Vr.alt(e,Ur.nil())}Z.opt=Kr;function Hr(e){return{parse:function(t){var r=e.parse(t);return r.successful?r:{candidates:[{firstToken:t,nextToken:t,result:void 0}],successful:!0,error:r.error}}}}Z.opt_sc=Hr;var $={},L={};Object.defineProperty(L,"__esModule",{value:!0});L.kmid=L.kright=L.kleft=L.apply=void 0;var Je=le;function Te(e,t){return{parse:function(r){var n=e.parse(r);return n.successful?{candidates:n.candidates.map(function(i){return{firstToken:r,nextToken:i.nextToken,result:t(i.result,[r,i.nextToken])}}),successful:!0,error:n.error}:n}}}L.apply=Te;function Xr(e,t){return Te(Je.seq(e,t),function(r){return r[0]})}L.kleft=Xr;function Gr(e,t){return Te(Je.seq(e,t),function(r){return r[1]})}L.kright=Gr;function Wr(e,t,r){return Te(Je.seq(e,t,r),function(n){return n[1]})}L.kmid=Wr;var Jr=V&&V.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],l=0,o=s.length;l<o;l++,i++)n[i]=s[l];return n};Object.defineProperty($,"__esModule",{value:!0});$.lrec_sc=$.lrec=$.list_n=$.list_sc=$.list=$.rep_n=$.repr=$.rep_sc=$.rep=void 0;var F=L,ee=_,ae=le,Qr=P;function Qe(e){var t=Mt(e);return{parse:function(r){var n=t.parse(r);return n.successful?{candidates:n.candidates.reverse(),successful:!0,error:n.error}:n}}}$.rep=Qe;function Ye(e){return{parse:function(t){for(var r,n=[{firstToken:t,nextToken:t,result:[]}];;){var i=n;n=[];for(var s=0,l=i;s<l.length;s++){var o=l[s],u=e.parse(o.nextToken);if(r=ee.betterError(r,u.error),u.successful)for(var a=0,c=u.candidates;a<c.length;a++){var f=c[a];f.nextToken!==o.nextToken&&n.push({firstToken:o.firstToken,nextToken:f.nextToken,result:o.result.concat([f.result])})}}if(n.length===0){n=i;break}}return ee.resultOrError(n,r,!0)}}}$.rep_sc=Ye;function Mt(e){return{parse:function(t){for(var r,n=[{firstToken:t,nextToken:t,result:[]}],i=0;i<n.length;i++){var s=n[i],l=e.parse(s.nextToken);if(r=ee.betterError(r,l.error),l.successful)for(var o=0,u=l.candidates;o<u.length;o++){var a=u[o];a.nextToken!==s.nextToken&&n.push({firstToken:s.firstToken,nextToken:a.nextToken,result:s.result.concat([a.result])})}}return ee.resultOrError(n,r,!0)}}}$.repr=Mt;function Nt(e,t){return{parse:function(r){for(var n,i=[{firstToken:r,nextToken:r,result:[]}],s=0;s<t;s++){for(var l=[],o=0,u=i;o<u.length;o++){var a=u[o],c=e.parse(a.nextToken);if(n=ee.betterError(n,c.error),c.successful)for(var f=0,d=c.candidates;f<d.length;f++){var v=d[f];l.push({firstToken:a.firstToken,nextToken:v.nextToken,result:a.result.concat([v.result])})}}if(l.length===0)return{successful:!1,error:n};i=l}return ee.resultOrError(i,n,!0)}}}$.rep_n=Nt;function Ze(e){var t=e[0],r=e[1];return Jr([t],r)}function Yr(e,t){return F.apply(ae.seq(e,Qe(F.kright(t,e))),Ze)}$.list=Yr;function Zr(e,t){return F.apply(ae.seq(e,Ye(F.kright(t,e))),Ze)}$.list_sc=Zr;function en(e,t,r){return r<1?Qr.succ([]):r===1?F.apply(e,function(n){return[n]}):F.apply(ae.seq(e,Nt(F.kright(t,e),r-1)),Ze)}$.list_n=en;function It(e){return function(t){for(var r=t[0],n=0,i=t[1];n<i.length;n++){var s=i[n];r=e(r,s)}return r}}function tn(e,t,r){return F.apply(ae.seq(e,Qe(t)),It(r))}$.lrec=tn;function rn(e,t,r){return F.apply(ae.seq(e,Ye(t)),It(r))}$.lrec_sc=rn;var Se={};Object.defineProperty(Se,"__esModule",{value:!0});Se.amb=void 0;function nn(e){return{parse:function(t){var r=e.parse(t);if(!r.successful)return r;for(var n=new Map,i=0,s=r.candidates;i<s.length;i++){var l=s[i],o=n.get(l.nextToken);o===void 0?n.set(l.nextToken,[l]):o.push(l)}return{candidates:Array.from(n.values()).map(function(u){return{firstToken:u[0].firstToken,nextToken:u[0].nextToken,result:u.map(function(a){return a.result})}}),successful:!0,error:r.error}}}}Se.amb=nn;var te={};Object.defineProperty(te,"__esModule",{value:!0});te.errd=te.err=void 0;function sn(e,t){return{parse:function(r){var n=e.parse(r);return n.successful?n:{successful:!1,error:{kind:"Error",pos:n.error.pos,message:t}}}}}te.err=sn;function ln(e,t,r){return{parse:function(n){var i=e.parse(n);return i.successful?i:{successful:!0,candidates:[{firstToken:n,nextToken:n,result:r}],error:{kind:"Error",pos:i.error.pos,message:t}}}}}te.errd=ln;var U={};Object.defineProperty(U,"__esModule",{value:!0});U.expectSingleResult=U.expectEOF=U.rule=void 0;var Ce=C,ht=_,on=function(){function e(){}return e.prototype.setPattern=function(t){this.parser=t},e.prototype.parse=function(t){if(this.parser===void 0)throw new Error("Rule has not been initialized. setPattern is required before calling parse.");return this.parser.parse(t)},e}();function un(){return new on}U.rule=un;function cn(e){if(!e.successful)return e;if(e.candidates.length===0)return{successful:!1,error:{kind:"Error",pos:void 0,message:"No result is returned."}};for(var t=[],r=e.error,n=0,i=e.candidates;n<i.length;n++){var s=i[n];s.nextToken===void 0?t.push(s):r=ht.betterError(r,{kind:"Error",pos:s.nextToken===void 0?void 0:s.nextToken.pos,message:'The parser cannot reach the end of file, stops at "'+s.nextToken.text+'" at position '+JSON.stringify(s.nextToken.pos)+"."})}return ht.resultOrError(t,r,t.length!==0)}U.expectEOF=cn;function an(e){if(!e.successful)throw new Ce.TokenError(e.error.pos,e.error.message);if(e.candidates.length===0)throw new Ce.TokenError(void 0,"No result is returned.");if(e.candidates.length!==1)throw new Ce.TokenError(void 0,"Multiple results are returned.");return e.candidates[0].result}U.expectSingleResult=an;var re={};Object.defineProperty(re,"__esModule",{value:!0});re.makeParserModule=re.lazy=void 0;function Lt(e){return{parse:function(t){return e().parse(t)}}}re.lazy=Lt;var fn=function(e,t,r){return Object.defineProperty(e,t,{configurable:!0,writable:!1,enumerable:!0,value:r})};function dn(e){for(var t=Object.create(null),r=function(u,a){t=fn(t,u,Lt(function(){return a(t)}))},n=0,i=Object.entries(e);n<i.length;n++){var s=i[n],l=s[0],o=s[1];r(l,o)}return t}re.makeParserModule=dn;(function(e){var t=V&&V.__createBinding||(Object.create?function(n,i,s,l){l===void 0&&(l=s),Object.defineProperty(n,l,{enumerable:!0,get:function(){return i[s]}})}:function(n,i,s,l){l===void 0&&(l=s),n[l]=i[s]}),r=V&&V.__exportStar||function(n,i){for(var s in n)s!=="default"&&!i.hasOwnProperty(s)&&t(i,n,s)};Object.defineProperty(e,"__esModule",{value:!0}),r(C,e),r(_,e),r(P,e),r(ke,e),r(le,e),r(ce,e),r(Oe,e),r(Z,e),r($,e),r(L,e),r(Se,e),r(te,e),r(U,e),r(re,e)})(b);var x=(e=>(e[e.Sym=0]="Sym",e[e.Const=1]="Const",e[e.Mul=2]="Mul",e[e.Add=3]="Add",e[e.Sub=4]="Sub",e[e.Div=5]="Div",e))(x||{});class hn{constructor(t){this.value=t}type=0;isConst(){return!1}isBinOp(){return!1}constEval(){}references(){return[this.value]}}class gn{constructor(t){this.value=t}type=1;isConst(){return!0}isBinOp(){return!1}constEval(){return this.value}references(){return[]}}class de{constructor(t,r,n){this.type=t,this.left=r,this.right=n}isConst(){return this.left.isConst()&&this.right.isConst()}isBinOp(){return!0}constEval(){if(this.isConst())switch(this.type){case 2:return this.left.constEval()*this.right.constEval();case 3:return this.left.constEval()+this.right.constEval();case 4:return this.left.constEval()-this.right.constEval();case 5:return this.left.constEval()/this.right.constEval()}}references(){return this.left.references().concat(this.right.references())}}const vn=b.buildLexer([[!0,/^\-?\d+(\.\d+)?/g,0],[!0,/^[a-zA-Z]+/g,1],[!0,/^\+/g,2],[!0,/^\-/g,3],[!0,/^\*/g,4],[!0,/^\//g,5],[!0,/^\(/g,6],[!0,/^\)/g,7],[!1,/^\s+/g,8]]);function bn(e){return new gn(+e.text)}function pn(e){return new hn(e.text)}function Bt(e,t){switch(t[0].text){case"+":return new de(x.Add,e,t[1]);case"-":return new de(x.Sub,e,t[1]);case"*":return new de(x.Mul,e,t[1]);case"/":return new de(x.Div,e,t[1]);default:throw new Error(`Unknown binary operator: ${t[0].text}`)}}const ze=b.rule(),Ve=b.rule(),et=b.rule();ze.setPattern(b.alt(b.apply(b.tok(0),bn),b.apply(b.tok(1),pn),b.kmid(b.str("("),et,b.str(")"))));Ve.setPattern(b.lrec_sc(ze,b.seq(b.alt(b.str("*"),b.str("/")),ze),Bt));et.setPattern(b.lrec_sc(Ve,b.seq(b.alt(b.str("+"),b.str("-")),Ve),Bt));const Dt=e=>e.split(`
`).filter(r=>r.length>0).map(r=>{const[n,i]=r.split("="),s=b.expectSingleResult(b.expectEOF(et.parse(vn.parse(i))));return[n.trim(),s]}).reduce((r,[n,i])=>({...r,[n]:i}),{});var D=(e=>(e[e.Dependent=0]="Dependent",e[e.Bound=1]="Bound",e[e.Free=2]="Free",e))(D||{});class tt{}class je extends tt{constructor(t,r){super(),this.symbol=t,this.calculation=r}type=0;attemptBinding(t){if(this.calculation.type===0){const r=t.get(this.calculation.dependencies);if(r!=null)return new ne(this.symbol,r.value)}else{const[r,...n]=this.calculation.dependencies,i=t.get(r);if(i==null)return this;let s=i.value;for(const l of n){const o=t.get(l);if(o==null)return this;switch(this.calculation.type){case 1:s+=o.value;break;case 2:s-=o.value;break;case 3:s*=o.value;break;case 4:s/=o.value;break}}return new ne(this.symbol,s)}return this}}class ne extends tt{constructor(t,r){super(),this.symbol=t,this.value=r}type=1;attemptBinding(t){return this}}class Rt extends tt{constructor(t){super(),this.symbol=t}type=2;attemptBinding(t){const r=t.get(this.symbol);return r!=null?new ne(this.symbol,r.value):this}}var N=(e=>(e[e.Ref=0]="Ref",e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e))(N||{});const Ft=e=>e.filter(t=>t instanceof Rt).sort((t,r)=>t.symbol.localeCompare(r.symbol)),yn=(e,t)=>{let r=500,n=!0;for(;r-- >0&&n;){n=!1;for(let i=0;i<e.length;i++)e[i]=e[i].attemptBinding(t),e[i]instanceof ne?t.set(e[i].symbol,e[i]):n=!0}return r<=0?{completed:!1,result:e}:{completed:!0,result:e}};class mn{counter=0;next(){return(this.counter++).toString(16)}}const qt=e=>{const t=new Set;for(const n of Object.values(e))for(const i of n.references())t.add(i);for(const n of Object.keys(e))t.delete(n);const r=new wn;for(const n of t)r.addFreeVariable(n);for(const n of Object.values(e))r.addExpression(n);for(const[n,i]of Object.entries(e))r.addBinding(n,i);return r.output};class wn{output=[];ssaTable=new Map;freeTable=new Map;counter=new mn;referenceTable=new Map;constructor(){}addFreeVariable(t){if(!this.freeTable.has(t)){const r=new Rt(t);this.output.push(r),this.freeTable.set(t,r)}}addExpression(t){const r=t.constEval();if(r!=null)return this.addConst(t,r);switch(t.type){case x.Sym:return this.addRef(t);case x.Const:return this.addConst(t,t.value);case x.Mul:case x.Add:case x.Sub:case x.Div:return this.addBinOp(t)}}addRef(t){const r=this.referenceTable.get(t.value);if(r)return r.symbol;const n=`ref-${t.value}-${this.counter.next()}`;this.ssaTable.set(t,n);const i=new je(n,{type:N.Ref,dependencies:t.value});return this.output.push(i),this.referenceTable.set(t.value,i),n}addConst(t,r){const n=`const-${this.counter.next()}`;return this.ssaTable.set(t,n),this.output.push(new ne(n,r)),n}addBinOp(t){const r=`math-${this.counter.next()}`;this.ssaTable.set(t,r);let n;switch(t.type){case x.Mul:n=N.Mul;break;case x.Add:n=N.Add;break;case x.Sub:n=N.Sub;break;case x.Div:n=N.Div;break}return this.output.push(new je(r,{type:n,dependencies:[this.addExpression(t.left),this.addExpression(t.right)]})),r}addBinding(t,r){const n=this.ssaTable.get(r);if(!n)throw new Error("symbol not found, this should never happen");this.output.push(new je(t,{type:N.Ref,dependencies:n}))}}const xn=`x = y * 2
y = z + z - p / 5
z = 12`,$n=()=>Ke(xn),kn=e=>We({error:null,tree:e}),On=e=>We({input:e,freeVariables:Ft(e),bindings:{}}),Tn=()=>We({completed:!0,result:[]});class Sn{constructor(t,r,n,i,s,l,o,u){this.setParseTree=t,this.parseTree=r,this.setSolverInput=n,this.solverInput=i,this.setSolution=s,this.solution=l,this.setText=o,this.text=u,this.setRules=Tr(a=>{console.log("parsing equations",a);let c;try{c=Dt(a),this.setParseTree(Ae({error:null,tree:c})),console.log("parsed",c)}catch(d){this.setParseTree("error",d),console.error("parsingError",d)}let f;try{f=qt(c),this.setSolverInput(Ae({input:f,freeVariables:Ft(f),bindings:this.solverInput.bindings})),console.log("compiled",f)}catch(d){console.error("compiler error",d)}this.attemptSolve()},150)}setRules;attemptSolve(){const t=this.solverInput.input.map(i=>i),r=new Map;for(const[i,s]of Object.entries(this.solverInput.bindings))s!=null&&r.set(i,new ne(i,s));const n=yn(t,r);this.setSolution(Ae(n)),console.log("solved",n)}}const _n=()=>{const[e,t]=$n(),r=Dt(e()),[n,i]=kn(r),s=qt(r),[l,o]=On(s),[u,a]=Tn();return new Sn(i,n,o,l,a,u,t,e)},En=["bg-fuchsia-200","bg-teal-200","bg-lime-200","bg-sky-200","bg-indigo-200","bg-cyan-200"],zt=["border-sky-300","border-indigo-300","border-cyan-300","border-fuchsia-300","border-teal-300","border-rose-300","border-lime-300"],Pn=e=>{let t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);t=(t<<5)-t+n,t|=0}return t},Vt=(...e)=>e.join(" "),An=e=>rt(En,e),Cn=e=>Mn(zt,e),jn=e=>rt(zt,e),Mn=(e,t)=>rt(e,Pn(t)),rt=(e,t)=>e[t%e.length],Nn=p('<svg stroke-width="0"></svg>',2),In=p("<title></title>",2);function _e(e,t){const r=st(e.a,t),[n,i]=tr(r,["src"]);return(()=>{const s=Nn.cloneNode(!0);return br(s,st({get stroke(){return e.a.stroke},get color(){return t.color||"currentColor"},get style(){return{...t.style,overflow:"visible"}}},i,{get height(){return t.size||"1em"},get width(){return t.size||"1em"},get innerHTML(){return e.c},xmlns:"http://www.w3.org/2000/svg"}),!0,!0),g(s,()=>wr,null),g(s,(()=>{const l=q(()=>!!t.title);return()=>l()&&(()=>{const o=In.cloneNode(!0);return g(o,()=>t.title),o})()})(),null),s})()}function Ln(e){return _e({a:{viewBox:"0 0 1024 1024"},c:'<path d="M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"/><path d="M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"/>'},e)}function Bn(e){return _e({a:{viewBox:"0 0 1024 1024"},c:'<path d="M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"/><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"/>'},e)}function Dn(e){return _e({a:{viewBox:"0 0 1024 1024"},c:'<path d="M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"/><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"/>'},e)}function Rn(e){return _e({a:{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"},c:'<path d="M8 12h8M12 16h0M12 8h0"/><circle cx="12" cy="12" r="10"/>'},e)}const Ut=p("<div>"),Fn=p('<div><h3 class="text-lg mb-2"></h3><div class="flex gap-2 items-center">'),Ue=e=>h($e,{get fallback(){return h(Vn,{get node(){return e.value},get depth(){return e.depth}})},get children(){return[h(E,{get when(){return e.value.type===x.Sym?e.value:!1},children:t=>h(qn,{get symbol(){return t()}})}),h(E,{get when(){return e.value.type===x.Const?e.value:!1},children:t=>h(zn,{get constant(){return t()}})})]}}),qn=e=>(()=>{const t=Ut();return g(t,()=>e.symbol.value),I(()=>ie(t,Vt("rounded px-2 border-2",Cn(e.symbol.value)))),t})(),zn=e=>(()=>{const t=Ut();return g(t,()=>e.constant.value),I(()=>ie(t,Vt("rounded border-2 border-slate-500 px-2",An(e.constant.value)))),t})(),Vn=e=>(()=>{const t=Fn(),r=t.firstChild,n=r.nextSibling;return g(r,h(Un,{get node(){return e.node}})),g(n,h(Ue,{get value(){return e.node.left},get depth(){return e.depth+1}}),null),g(n,h(Ue,{get value(){return e.node.right},get depth(){return e.depth+1}}),null),I(()=>ie(t,"rounded border-2 p-1 "+jn(e.depth))),t})(),Un=e=>h($e,{get children(){return[h(E,{get when(){return e.node.type===x.Add},get children(){return h(Dn,{})}}),h(E,{get when(){return e.node.type===x.Sub},get children(){return h(Bn,{})}}),h(E,{get when(){return e.node.type===x.Div},get children(){return h(Rn,{})}}),h(E,{get when(){return e.node.type===x.Mul},get children(){return h(Ln,{})}})]}}),Kn=p('<div class="flex flex-col sm:flex-row gap-2 flex-wrap">'),Hn=p('<div class="flex flex-col gap-1 border-2 border-slate rounded min-w-[6rem]"><div class="flex gap-2 border-b border-slate-200 p-2"><h2 class="bold"></h2><span>=</span></div><div class="flex items-center justify-center grow p-2">'),Xn=e=>{const t=()=>{const r=Object.entries(e.ast);return r.sort(),r};return(()=>{const r=Kn();return g(r,h(He,{get each(){return t()},children:n=>h(Gn,{get lhs(){return n[0]},get rhs(){return n[1]}})})),r})()},Gn=e=>(()=>{const t=Hn(),r=t.firstChild,n=r.firstChild,i=r.nextSibling;return g(n,()=>e.lhs),g(i,h(Ue,{get value(){return e.rhs},depth:0})),t})(),Wn=p('<div class="flex flex-col gap-4">'),Jn=p('<div class="flex gap-2"><label></label> =<input class="border border-zinc-200 rounded" type="number">'),Qn=e=>(()=>{const t=Wn();return g(t,h(He,{get each(){return e.value},children:r=>h(Yn,{value:r,get bindings(){return e.bindings},get setBindings(){return e.setBindings}})})),t})(),Yn=e=>{const t=r=>{if(r.currentTarget.value!=null&&r.currentTarget.value!==""){const n=parseFloat(r.currentTarget.value);if(!isNaN(n)){e.setBindings(e.value.symbol,n);return}}e.setBindings(e.value.symbol,null)};return(()=>{const r=Jn(),n=r.firstChild,i=n.nextSibling,s=i.nextSibling;return g(n,()=>e.value.symbol),s.$$keyup=t,r})()};Xe(["keyup"]);const Zn=p('<div class="flex gap-8 flex-wrap">'),es=p("<div>"),ts=p('<div class="text-sm"><h2 class="text-lg p-2 rounded border-black border-2">'),rs=p('<div class="flex flex-col justify-center items-center">'),ns=p('<div><div class="text-sm">Value:</div><div>'),ss=p('<div class="text-sm"><div>Add Node</div><div class="grow flex flex-col justify-center items-center"><div></div><div>+</div><div>'),is=p('<div><div class="text-sm">Sub Node</div><div class="flex flex-col justify-center items-center"><div></div><div>-</div><div>'),ls=p('<div class="text-sm"><div>Mul Node</div><div class="flex flex-col justify-center items-center"><div></div><div>*</div><div>'),os=p('<div class="text-sm"><div>Div Node</div><div class="flex flex-col justify-center items-center"><div></div><div>/</div><div>'),us=p('<div class="text-sm"><div>Ref Node</div><div class="flex justify-center items-center gap-2"><div>→</div><div>'),cs=e=>{const t=n=>new Set(Object.keys(e.ast).concat(e.freeVariables.map(s=>s.symbol))).has(n),r=()=>{const n=e.outputs.filter(s=>t(s.symbol)),i=e.outputs.filter(s=>!t(s.symbol));return n.sort((s,l)=>s.symbol.localeCompare(l.symbol)),n.concat(i)};return(()=>{const n=Zn();return g(n,h(He,{get each(){return r()},children:i=>(()=>{const s=es();return g(s,h(as,{node:i}),null),g(s,h(ds,{node:i}),null),I(()=>ie(s,gs(i,t(i.symbol)))),s})()})),n})()},as=e=>(()=>{const t=ts(),r=t.firstChild;return g(t,h(fs,{get type(){return e.node.type}}),r),g(r,()=>e.node.symbol),t})(),fs=e=>h($e,{get children(){return[h(E,{get when(){return e.type===D.Bound},children:"Bound Variable"}),h(E,{get when(){return e.type===D.Free},children:"Free Variable"}),h(E,{get when(){return e.type===D.Dependent},children:"Computed Variable"})]}}),ds=e=>(()=>{const t=rs();return g(t,h(ge,{get when(){return e.node.type===D.Bound?e.node:!1},children:r=>(()=>{const n=ns(),i=n.firstChild,s=i.nextSibling;return g(s,()=>r().value.toFixed(2)),n})()}),null),g(t,h(ge,{get when(){return e.node.type===D.Dependent?e.node:!1},children:r=>h(hs,{get node(){return r()}})}),null),g(t,h(ge,{get when(){return e.node.type===D.Free},children:"Requires Input"}),null),t})(),hs=e=>h($e,{get children(){return[h(E,{get when(){return e.node.calculation.type===N.Add},get children(){const t=ss(),r=t.firstChild,n=r.nextSibling,i=n.firstChild,s=i.nextSibling,l=s.nextSibling;return g(i,()=>e.node.calculation.dependencies[0]),g(l,()=>e.node.calculation.dependencies[1]),t}}),h(E,{get when(){return e.node.calculation.type===N.Sub},get children(){const t=is(),r=t.firstChild,n=r.nextSibling,i=n.firstChild,s=i.nextSibling,l=s.nextSibling;return g(i,()=>e.node.calculation.dependencies[0]),g(l,()=>e.node.calculation.dependencies[1]),t}}),h(E,{get when(){return e.node.calculation.type===N.Mul},get children(){const t=ls(),r=t.firstChild,n=r.nextSibling,i=n.firstChild,s=i.nextSibling,l=s.nextSibling;return g(i,()=>e.node.calculation.dependencies[0]),g(l,()=>e.node.calculation.dependencies[1]),t}}),h(E,{get when(){return e.node.calculation.type===N.Div},get children(){const t=os(),r=t.firstChild,n=r.nextSibling,i=n.firstChild,s=i.nextSibling,l=s.nextSibling;return g(i,()=>e.node.calculation.dependencies[0]),g(l,()=>e.node.calculation.dependencies[1]),t}}),h(E,{get when(){return e.node.calculation.type===N.Ref},get children(){const t=us(),r=t.firstChild,n=r.nextSibling,i=n.firstChild,s=i.nextSibling;return g(s,()=>e.node.calculation.dependencies),t}})]}}),gs=(e,t)=>{let r="flex flex-col justify-between rounded border-2 p-4 w-44 h-48 ";switch(e.type){case D.Bound:r+=" border-green-500 bg-green-100 ";break;case D.Free:r+=" border-red-500 bg-red-100 ";break;case D.Dependent:r+=" border-zinc-200 bg-zinc-100 ";break}return t||(r+=" opacity-20 "),r},vs=p('<div class="p-8"><h1 class="text-2xl my-2 mb-4">Solver'),bs=p('<div class="flex gap-2 flex-wrap items-stretch justify-around mb-2">'),ps=p('<div class="flex flex-col border-2 border-slate-100 rounded p-8 grow"><h2 class="text-xl my-2 mb-4 ">Equations</h2><textarea class="overflow-hidden flex-grow rounded border-2 h-32 border-zinc-200"></textarea><div>'),ys=p('<div class="border-2 border-slate-100 rounded p-8 grow"><h2 class="mb-4 text-xl">Parse Tree'),ms=p('<div class="flex gap-2 flex-col sm:flex-row">'),ws=p('<div class="mt-8 my-2 border-2 border-slate-100 rounded p-8"><h2 class="mb-4 text-xl">Inputs'),xs=p('<div class="mt-8 my-2 border-2 border-slate-100 rounded p-8"><h2 class="mb-4 text-xl">Outputs'),$s=()=>{const e=_n();return e.attemptSolve(),h(ks,{get children(){return[h(Os,{get children(){return[h(Ts,{app:e}),h(Ss,{app:e})]}}),h(_s,{get children(){return[h(Es,{app:e}),h(Ps,{app:e})]}})]}})},ks=e=>{const t=me(()=>e.children);return(()=>{const r=vs();return r.firstChild,g(r,t,null),r})()},Os=e=>{const t=me(()=>e.children);return(()=>{const r=bs();return g(r,t),r})()},Ts=e=>(()=>{const t=ps(),r=t.firstChild,n=r.nextSibling,i=n.nextSibling;return n.$$keyup=s=>{e.app.setText(s.currentTarget.value),e.app.setRules(s.currentTarget.value)},g(i,h(ge,{get when(){return e.app.parseTree.error},children:s=>s().message})),I(()=>ie(i,e.app.parseTree.error?"mt-2 border-2 rounded bg-red-100 border-red-500":"")),I(()=>n.value=e.app.text()),t})(),Ss=e=>(()=>{const t=ys();return t.firstChild,g(t,h(Xn,{get ast(){return e.app.parseTree.tree}}),null),t})(),_s=e=>{const t=me(()=>e.children);return(()=>{const r=ms();return g(r,t),r})()},Es=e=>(()=>{const t=ws();return t.firstChild,g(t,h(Qn,{get value(){return e.app.solverInput.freeVariables},get bindings(){return e.app.solverInput.bindings},setBindings:(r,n)=>{e.app.setSolverInput("bindings",r,n),e.app.attemptSolve()}}),null),t})(),Ps=e=>(()=>{const t=xs();return t.firstChild,g(t,h(cs,{get outputs(){return e.app.solution.result},get freeVariables(){return e.app.solverInput.freeVariables},get ast(){return e.app.parseTree.tree}}),null),t})();Xe(["keyup"]);const As=document.getElementById("root");fr(()=>h($s,{}),As);
